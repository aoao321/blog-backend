<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aoao.blog.common.domain.mapper.ArticleTagRelMapper">

    <insert id="insertBatch">
        INSERT INTO t_article_tag_rel (article_id,tag_id)
            VALUES
                <foreach collection="list" item="item" separator="," >
                   ( #{item.articleId} , #{item.tagId})
                </foreach>
    </insert>
    <select id="selectArticleCountByTags" resultType="java.util.Map">
        SELECT t.name AS tagName,COUNT(*) AS articleCount FROM t_article_tag_rel at
        LEFT JOIN t_tag t
        ON at.tag_id = t.id AND t.is_deleted=0
        WHERE t.name IN
        <foreach collection="tagNames" item="tag" open="(" separator="," close=")">
            #{tag}
        </foreach>
        GROUP BY at.tag_id
    </select>
</mapper>
